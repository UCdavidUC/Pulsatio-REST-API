<script>
    angular.module('app', ['ngRoute', 'ngResource'])
        .facory('Medicos', ['$resource', function($resource){
            return $resource('/medicos/:username', null, {
                'update': { method: 'PUT' }
            });
        }])
        .controller('MDRegisterController', ['$scope', '$routeParams', 'Medicos', function($scope, $routeParams, Medico){
            $scope.save = function() {
                if(!$scope.medico || $scope.medico.length < 1) {
                    return;
                } else {
                    medico.$save(function() {
                        $scope.medicos.push(medico);
                        $scope.newMedico = '';
                    });
                }
            }
        }])
        .controller('MDLoginController', ['$scope', '$routeParams', 'Medico', '$location', function($scope, $routeParams, Medico, $location) {
            $scope.medico = Medicos.get({
                id: $routeParams.id
            });
            console.log('Here');
            $scope.find = function() {
                Medico.get({
                    email: $scope.medico._email, 
                    contrasena: $scope.medico.contrasena
                }, $scope.medico, function() {
                    $location.url('/');
                    console.log('searching user');
                });
            };
        }])
        .config(['$routeProvider', function($routeProvider) {
            console.log('routing...');
            $routeProvider.when('/register', {
                templateUrl: '/register.html',
                controller: 'MDRegisterController'
            }).when('/', {
                templateUrl: '/login.html',
                controller: 'MDLoginController'
            });
        }]);
</script>